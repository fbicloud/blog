

<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Debian11安装笔记 - FBICLOUD</title><meta name="Description" content="随心而动 随意而行"><meta property="og:url" content="https://blog.fbicloud.com/debian11-install/">
  <meta property="og:site_name" content="FBICLOUD">
  <meta property="og:title" content="Debian11安装笔记">
  <meta property="og:description" content="随心而动 随意而行">
  <meta property="og:locale" content="zh-CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-10-01T12:47:36+08:00">
    <meta property="article:modified_time" content="2022-10-01T12:47:36+08:00">
    <meta property="article:tag" content="Debian">
    <meta property="article:tag" content="笔记">
    <meta property="og:image" content="https://blog.fbicloud.com/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog.fbicloud.com/logo.png"><meta name="twitter:title" content="Debian11安装笔记">
<meta name="twitter:description" content="">
      <meta name="twitter:site" content="@xxxx">
<meta name="application-name" content="FBICLOUD">
<meta name="apple-mobile-web-app-title" content="FBICLOUD">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://blog.fbicloud.com/debian11-install/" /><link rel="prev" href="https://blog.fbicloud.com/esxi-install/" /><link rel="next" href="https://blog.fbicloud.com/stable-diffusion-webui/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.055364f5be272caa092b0e6654c165828707f8ab971e2656383a6d6392bc345e.css" integrity="sha256-BVNk9b4nLKoJKw5mVMFlgocH&#43;KuXHiZWODptY5K8NF4="><link rel="stylesheet" href="/css/color.b0a0f8c429ce52dfa2805b5f9e99ccdae1e8fbfd9adf4f3ddb409d8201fc0c5a.css" integrity="sha256-sKD4xCnOUt&#43;igFtfnpnM2uHo&#43;/2a308920CdggH8DFo="><link rel="stylesheet" href="/css/style.min.629927201e527bf01ff085b1ad51e61102057ff886ed693b8a8c18ab5d71f2ad.css" integrity="sha256-YpknIB5Se/Af8IWxrVHmEQIFf/iG7Wk7iowYq11x8q0="><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.43202d5486e011f9684a17bd6846b5c16a2619002bfc783f7e32e20dfb6bf857.css" integrity="sha256-QyAtVIbgEfloShe9aEa1wWomGQAr/Hg/fjLiDftr&#43;Fc=">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.43202d5486e011f9684a17bd6846b5c16a2619002bfc783f7e32e20dfb6bf857.css" integrity="sha256-QyAtVIbgEfloShe9aEa1wWomGQAr/Hg/fjLiDftr&#43;Fc="></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1&#43;AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css" integrity="sha256-X7rrn44l1&#43;AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript>
    
    
    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Debian11安装笔记",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.fbicloud.com\/debian11-install\/"
        },"genre": "posts","keywords": "debian, 笔记","wordcount":  1286 ,
        "url": "https:\/\/blog.fbicloud.com\/debian11-install\/","datePublished": "2022-10-01T12:47:36+08:00","dateModified": "2022-10-01T12:47:36+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "FBICLOUD"
            },"description": ""
    }
    </script><script src="//instant.page/5.1.1" defer type="module" integrity="sha384-MWfCL6g1OTGsbSwfuMHc8+8J2u71/LA8dzlIN3ycajckxuZZmF+DNjdm7O6H3PSq"></script>
</head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme; }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="FBICLOUD">FBICLOUD</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="#" class="menu-item theme-select" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                    <select class="color-theme-select" id="theme-select-desktop" title="切换主题">
                        <option value="light">浅色</option>
                        <option value="dark">深色</option>
                        <option value="black">黑色</option>
                        <option value="auto">跟随系统</option>
                    </select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="FBICLOUD">FBICLOUD</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a href="#" class="menu-item theme-select" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
                <select class="color-theme-select" id="theme-select-mobile" title="切换主题">
                    <option value="light">浅色</option>
                    <option value="dark">深色</option>
                    <option value="black">黑色</option>
                    <option value="auto">跟随系统</option>
                </select>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "false")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Debian11安装笔记</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><i class="author fas fa-user-circle fa-fw"></i><a href="https://blog.fbicloud.com/" title="Author" target="_blank" rel="noopener noreferrer author" class="author">FBICLOUD</a>
                </span>&nbsp;<span class="post-category">收录于 </span>&nbsp;<span class="post-category">类别 <a href="/categories/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/"><i class="far fa-folder fa-fw"></i>奇技淫巧</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-10-01">2022-10-01</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime="2022-10-01">2022-10-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1286 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 3 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#使用国内apt源">使用国内apt源</a></li>
    <li><a href="#配置sudo">配置sudo</a></li>
    <li><a href="#配置网络">配置网络</a></li>
    <li><a href="#设置时区">设置时区</a></li>
    <li><a href="#shell自定义">shell自定义</a></li>
    <li><a href="#防火墙">防火墙</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="details admonition warning open">
                <div class="details-summary admonition-title">
                    <i class="icon fas fa-exclamation-triangle fa-fwwarning"></i>警告<i class="details-icon fas fa-angle-right fa-fw"></i>
                </div>
                <div class="details-content">
                    <div class="admonition-content">
                        本文最后更新于 <span class="timeago" datetime="2022-10-01T12:47:36" title="October 1, 2022">2022-10-01</span>，文中内容可能已过时。</div>
                </div>
            </div><h2 id="使用国内apt源" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8%e5%9b%bd%e5%86%85apt%e6%ba%90" class="header-mark"></a>使用国内apt源</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; /etc/apt/sources.list <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">deb https://mirrors.ustc.edu.cn/debian/ bullseye main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">deb-src https://mirrors.ustc.edu.cn/debian/ bullseye main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">deb https://mirrors.ustc.edu.cn/debian/ bullseye-updates main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">deb-src https://mirrors.ustc.edu.cn/debian/ bullseye-updates main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">deb https://mirrors.ustc.edu.cn/debian/ bullseye-backports main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">deb-src https://mirrors.ustc.edu.cn/debian/ bullseye-backports main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">
</span></span></span><span class="line"><span class="cl"><span class="s">deb https://mirrors.ustc.edu.cn/debian-security/ bullseye-security main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">deb-src https://mirrors.ustc.edu.cn/debian-security/ bullseye-security main contrib non-free
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">apt update -y <span class="o">&amp;&amp;</span> apt upgrade -y
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<h2 id="配置sudo" class="headerLink">
    <a href="#%e9%85%8d%e7%bd%aesudo" class="header-mark"></a>配置sudo</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install sudo -y
</span></span><span class="line"><span class="cl">cat &gt; /etc/sudoers.d/username <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">username ALL=(ALL) NOPASSWD:ALL
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<h2 id="配置网络" class="headerLink">
    <a href="#%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c" class="header-mark"></a>配置网络</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo vim /etc/network/interfaces
</span></span><span class="line"><span class="cl"><span class="c1"># 重启</span>
</span></span><span class="line"><span class="cl">sudo systemctl restart networking
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<h2 id="设置时区" class="headerLink">
    <a href="#%e8%ae%be%e7%bd%ae%e6%97%b6%e5%8c%ba" class="header-mark"></a>设置时区</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 查看时区，有 CST 正确</span>
</span></span><span class="line"><span class="cl">date
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置</span>
</span></span><span class="line"><span class="cl">sudo timedatectl set-timezone Asia/Shanghai
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或者使用向导选择</span>
</span></span><span class="line"><span class="cl">tzselect
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<h2 id="shell自定义" class="headerLink">
    <a href="#shell%e8%87%aa%e5%ae%9a%e4%b9%89" class="header-mark"></a>shell自定义</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">命令自动补全忽略大小写
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;set completion-ignore-case on&#39;</span> &gt;&gt; ~/.inputrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">修改 vmrc（vim 配置文件）
</span></span><span class="line"><span class="cl">为当前用户创建 ~/.vimrc，内容参看上述 “配置 vi”
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">为将 .vimrc 添加到默认用户配置文件 cp ~/.vimrc /etc/skel/.vimrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ll 常规版
</span></span><span class="line"><span class="cl">一般 Linux 中默认定义了 ll 别名，但参数比较少，需要使用更加强大的 ll 别名。
</span></span><span class="line"><span class="cl">Debian 默认并没有定义 ll 别名。
</span></span><span class="line"><span class="cl">写入环境变量（当前用户优先执行）：
</span></span><span class="line"><span class="cl">bash：
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;alias ll=&#34;ls -lahF --color=auto --time-style=long-iso&#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">高级版 ls：以数字显示权限
</span></span><span class="line"><span class="cl">这里我们把命令叫做 lll
</span></span><span class="line"><span class="cl">命令：
</span></span><span class="line"><span class="cl">ls -lahF --color<span class="o">=</span>auto --time-style<span class="o">=</span>long-iso <span class="p">|</span> awk <span class="s1">&#39;{k=0;s=0;for(i=0;i&lt;=8;i++){k+=((substr($1,i+2,1)~/[rwxst]/)*2^(8-i))}j=4;for(i=4;i&lt;=10;i+=3){s+=((substr($1,i,1)~/[stST]/)*j);j/=2}if(k){printf(&#34;%0o%0o &#34;,s,k)}print}&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">创建文件
</span></span><span class="line"><span class="cl">在使用 cat EOF 中出现 $ 变量通常会直接被执行，显示执行的结果。若想保持 $ 变量不变需要使用 <span class="se">\ </span>符进行注释。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 如果非 root 用户，切换到 root</span>
</span></span><span class="line"><span class="cl">sudo -i
</span></span><span class="line"><span class="cl">cat &gt; /usr/local/bin/lll <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="s">ls -lahF --color=auto --time-style=long-iso | awk &#39;{k=0;s=0;for(i=0;i&lt;=8;i++){k+=((substr(\$1,i+2,1)~/[rwxst]/)*2^(8-i))}j=4;for(i=4;i&lt;=10;i+=3){s+=((substr(\$1,i,1)~/[stST]/)*j);j/=2}if(k){printf(&#34;%0o%0o &#34;,s,k)}print}&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 赋予执行权限：</span>
</span></span><span class="line"><span class="cl">chmod +x /usr/local/bin/lll
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 如果非 root 用户，执行完毕退出</span>
</span></span><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">写入环境变量（可选配置，默认不需要）：
</span></span><span class="line"><span class="cl">bash
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;alias lll=&#34;/usr/local/bin/lll&#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span></code></pre></td></tr></table>
</div>
</div><p>​</p>
<h2 id="防火墙" class="headerLink">
    <a href="#%e9%98%b2%e7%81%ab%e5%a2%99" class="header-mark"></a>防火墙</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install -y nftables
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> nftables.service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#清空当前规则集：</span>
</span></span><span class="line"><span class="cl">nft flush ruleset
</span></span><span class="line"><span class="cl"><span class="c1">#查询当前规则集：</span>
</span></span><span class="line"><span class="cl">nft list ruleset
</span></span><span class="line"><span class="cl"><span class="c1">#添加一个表：</span>
</span></span><span class="line"><span class="cl">nft add table inet filter
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#添加input、forward和output三个基本链。input和forward的默认策略是drop。output的默认策略是accept。</span>
</span></span><span class="line"><span class="cl">nft add chain inet filter input <span class="o">{</span> <span class="nb">type</span> filter hook input priority <span class="m">0</span> <span class="se">\;</span> policy drop <span class="se">\;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">nft add chain inet filter forward <span class="o">{</span> <span class="nb">type</span> filter hook forward priority <span class="m">0</span> <span class="se">\;</span> policy drop <span class="se">\;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">nft add chain inet filter output <span class="o">{</span> <span class="nb">type</span> filter hook output priority <span class="m">0</span> <span class="se">\;</span> policy accept <span class="se">\;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#添加两个与TCP和UDP关联的常规链：</span>
</span></span><span class="line"><span class="cl">nft add chain inet filter TCP
</span></span><span class="line"><span class="cl">nft add chain inet filter UDP
</span></span><span class="line"><span class="cl"><span class="c1">#related和established的流量会accept：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ct state related,established accept
</span></span><span class="line"><span class="cl"><span class="c1">#loopback接口的流量会accept：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input iif lo accept
</span></span><span class="line"><span class="cl"><span class="c1">#无效的流量会drop：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ct state invalid drop
</span></span><span class="line"><span class="cl"><span class="c1">#新的echo请求（ping）会accept：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ip protocol icmp icmp <span class="nb">type</span> echo-request ct state new accept
</span></span><span class="line"><span class="cl"><span class="c1">#新的UDP流量跳转到UDP链：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ip protocol udp ct state new jump UDP
</span></span><span class="line"><span class="cl"><span class="c1">#新的TCP流量跳转到TCP链：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ip protocol tcp tcp flags <span class="se">\&amp;</span> <span class="se">\(</span>fin<span class="se">\|</span>syn<span class="se">\|</span>rst<span class="se">\|</span>ack<span class="se">\)</span> <span class="o">==</span> syn ct state new jump TCP
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#未由其他规则处理的所有通信会reject：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter input ip protocol udp reject
</span></span><span class="line"><span class="cl">nft add rule inet filter input ip protocol tcp reject with tcp reset
</span></span><span class="line"><span class="cl">nft add rule inet filter input counter reject with icmp <span class="nb">type</span> prot-unreachable
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#web服务器的连接端口80:</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter TCP tcp dport <span class="m">80</span> accept
</span></span><span class="line"><span class="cl"><span class="c1">#打开web服务器HTTPS连接端口443：</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter TCP tcp dport <span class="m">443</span> accept
</span></span><span class="line"><span class="cl"><span class="c1">#允许SSH连接端口22:</span>
</span></span><span class="line"><span class="cl">nft add rule inet filter TCP tcp dport <span class="m">22</span> accept
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#NAT</span>
</span></span><span class="line"><span class="cl"><span class="c1">#删除规则表 dnat1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#nft delete table ip dnat1 </span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#增加规则表 dnat1</span>
</span></span><span class="line"><span class="cl">nft add table ip dnat1 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#在表dnat1中增加一条链 prerouting [SNAT]</span>
</span></span><span class="line"><span class="cl">nft add chain dnat1 prerouting <span class="o">{</span> <span class="nb">type</span> nat hook prerouting priority <span class="m">0</span> <span class="se">\;</span><span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#在表dnat1中增加一条链 postrouting [DNAT]</span>
</span></span><span class="line"><span class="cl">nft add chain dnat1 postrouting <span class="o">{</span> <span class="nb">type</span> nat hook postrouting priority <span class="m">100</span> <span class="se">\;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">nft add rule dnat1 prerouting ip daddr 192.168.1.1 tcp dport <span class="m">80</span> counter dnat 172.16.1.2:80
</span></span><span class="line"><span class="cl">nft add fule dnat1 postrouting ip daddr 172.16.1.2 tcp dport <span class="m">80</span> counter snat to 172.16.1.1 
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">nft add rule dnat1 prerouting ip saddr 172.16.1.2 tcp sport <span class="m">80</span> counter dnat 192.168.1.2
</span></span><span class="line"><span class="cl">nft add rule dnat1 postrouting ip saddr 172.16.1.2 tcp sport <span class="m">80</span> counter snat to 192.168.1.1
</span></span></code></pre></td></tr></table>
</div>
</div></div>

        


<h2>相关内容</h2>
<div class="related-container">
    <div class="related-item-container">
            <h2 class="related-title">
                <a href="/esxi-install/">Esxi安装笔记</a>
            </h2>
        </div>
    

</div>

<div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2022-10-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/debian11-install/index.md target="_blank" rel="noopener noreferrer">阅读原始文档</a>
                    </span></div>
            <div class="post-info-share">
                <span><a href="#" title="分享到 Twitter" data-sharer="twitter" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记" data-via="xxxx" data-hashtags="debian,笔记"><i class="fab fa-twitter fa-fw"></i></a><a href="#" title="分享到 Facebook" data-sharer="facebook" data-url="https://blog.fbicloud.com/debian11-install/" data-hashtag="debian"><i class="fab fa-facebook-square fa-fw"></i></a><a href="#" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="#" title="分享到 Line" data-sharer="line" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="#" title="分享到 微博" data-sharer="weibo" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记"><i class="fab fa-weibo fa-fw"></i></a><a href="#" title="分享到 Myspace" data-sharer="myspace" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="#" title="分享到 Blogger" data-sharer="blogger" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="#" title="分享到 Evernote" data-sharer="evernote" data-url="https://blog.fbicloud.com/debian11-install/" data-title="Debian11安装笔记"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/debian/">Debian</a>,&nbsp;<a href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/esxi-install/" class="prev" rel="prev" title="Esxi安装笔记"><i class="fas fa-angle-left fa-fw"></i>Esxi安装笔记</a>
            <a href="/stable-diffusion-webui/" class="next" rel="next" title="Stable Diffusion Webui部署">Stable Diffusion Webui部署<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.125.5">Hugo</a> 强力驱动&nbsp;|&nbsp;主题 - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.3.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://blog.fbicloud.com/" target="_blank" rel="noopener noreferrer">FBICLOUD</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div><script>
                    if('serviceWorker' in navigator) {
                        navigator.serviceWorker
                            .register('/sw.min.js', { scope: '/' })
                            .then(function(registration) {
                            });
                
                        navigator.serviceWorker
                            .ready
                            .then(function(registration) {
                            });
                    }
                </script></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div id="cookieconsent-container"></div><div class="assets"><link rel="stylesheet" href="/lib/katex/katex.min.80c44de3feaa7842f33b5c1b15af2a40b53c91fb85d9d9c03e25282340138f1f.css" integrity="sha256-gMRN4/6qeELzO1wbFa8qQLU8kfuF2dnAPiUoI0ATjx8="><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.cf8e3e934d92a839d209ffdac331fa693da5958a6dff2c8788a4713cc1f50a47.css" integrity="sha256-z44&#43;k02SqDnSCf/awzH6aT2llYpt/yyHiKRxPMH1Ckc=">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.cf8e3e934d92a839d209ffdac331fa693da5958a6dff2c8788a4713cc1f50a47.css" integrity="sha256-z44&#43;k02SqDnSCf/awzH6aT2llYpt/yyHiKRxPMH1Ckc="></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.cd0d0b6e50ff01ff2f3a9a70d7cfb66a7c6cb9acf7a566325568be6d3bd31fc4.css" integrity="sha256-zQ0LblD/Af8vOppw18&#43;2anxsuaz3pWYyVWi&#43;bTvTH8Q="><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.92de6dec051677787aed63503575b2f9be73f21f2745574e59647bc139a92d40.js" integrity="sha256-kt5t7AUWd3h67WNQNXWy&#43;b5z8h8nRVdOWWR7wTmpLUA="></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.11be927cda59c8b6019ebbea838285c5beaf21183ea4b83dbd4e4fbf9413ce4a.js" integrity="sha256-Eb6SfNpZyLYBnrvqg4KFxb6vIRg&#43;pLg9vU5Pv5QTzko="></script><script type="text/javascript" src="/lib/sharer/sharer.min.8fe10eb615eb163a20f795484430a012805ec7c8c11df52df54ddb7a46084254.js" integrity="sha256-j&#43;EOthXrFjog95VIRDCgEoBex8jBHfUt9U3bekYIQlQ="></script><script type="text/javascript" src="/lib/katex/katex.min.863e38ee9c68ab4ec9f35cfdd66bcd54a0c3a3631365fdfbd06a333151887c80.js" integrity="sha256-hj447pxoq07J81z91mvNVKDDo2MTZf370GozMVGIfIA=" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.9cb8dacfc086c2966c9ec4ba54f4a2dc43b7cbe2b33cec1a2743d886c7fb47a7.js" integrity="sha256-nLjaz8CGwpZsnsS6VPSi3EO3y&#43;KzPOwaJ0PYhsf7R6c=" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.52ce78fab4860d24ef22128a52ce24ca01368a9034457a565a1d3fccbab0ddbb.js" integrity="sha256-Us54&#43;rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs=" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.5c0a121a8b490afc85860a522347aeb34fb508c6b23044e5d29f6b2194227b51.js" integrity="sha256-XAoSGotJCvyFhgpSI0eus0&#43;1CMayMETl0p9rIZQie1E=" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.e55842a856a6d829feca3c3ad736c136b6c7549e9247274f78aa296259e06e24.js" integrity="sha256-5VhCqFam2Cn&#43;yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" defer></script><script type="text/javascript" src="/js/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>